<!DOCTYPE HTML>
<html>
<head>
   <title>NodeSetModelImport</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "html_xmlimport.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">

<table width="100%" border="0" cellspacing="0" cellpadding="10">
  <tr valign="middle" bgcolor="#99CCFF">
    <td>
      <p>
        <table width="100%" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td style="vertical-align:middle;">
              <p style="font-family:Verdana; font-size:9pt; font-style:italic;">OPC UA C++ Server &amp; Client SDK V6.00</p>
              <p style="font-family:Verdana; font-size:9pt; font-weight:bold;">NodeSetModelImport</p>
            </td>
          </tr>
        </table>
      </p>
    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="html_welcome.htm">Top</a>&nbsp;
     <a href="html_sampleauditevents.htm">Previous</a>&nbsp;
     <a href="samplecomplexdatatype.htm">Next</a>
     </span>
    </td>
  </tr>
  <tr bgcolor="white">
      <td colspan="2">
          <p><a id="hdr"></a>This sample shows a server importing Objects, Variables and Methods from a XML file to the address space</p>
<p>&nbsp;</p>
<h3 class="p_Heading3"><span class="f_Heading3">Where to Find</span></h3>
<p class="p_Paragraph"><span class="f_Paragraph">The sample projects are located in the directory: &quot;</span><span class="f_FixedSize">&lt;InstallDir&gt;/Apps/Samples/Cpp/NodeSetModelImport</span><span class="f_Paragraph">&quot;. The server is in the subdirectory &quot;</span><span class="f_FixedSize">NodeSetModelImportServer</span><span class="f_Paragraph">&quot; and the xml file for import is in the &quot;</span><span class="f_FixedSize">ImportXML</span><span class="f_Paragraph">&quot; subdirectory.</span></p>
<h3 class="p_Heading3"><span class="f_Heading3">Running the Sample</span></h3>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph">The server application requires an application instance certificate. Please refer to the topic <a href="html_setupcertificates.htm" class="topiclink">Setting up a Certificate Store</a> that lists the required steps to create such a certificate. The path to the instance certificate is specified by the global variable </span><span class="f_FixedSize">g_applicationCertificate</span> <span class="f_Paragraph">at the top of </span><span class="f_FixedSize">ServerImportXML.cpp</span><span class="f_Paragraph">.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph">Compile and run the sample application </span><span class="f_Reference">ServerImportXML</span><span class="f_Paragraph">. The server is listening for incoming connections at the address </span><span class="f_FixedSize">opc.tcp://localhost:4880</span><span class="f_Paragraph">.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph">Connect to the sample server with your favorite OPC UA client (e.g. Softing OPC UA Client) and browse the server's address space.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 13px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Courier New';color:#000000;">o</span></td><td style="border:none"><span class="f_Paragraph">Browse the folder </span><span class="f_FixedSize">VariableTypes</span><span class="f_Paragraph"> which is organized below </span><span class="f_FixedSize">Types</span><span class="f_Paragraph"> folder and observe that there is a </span><span class="f_FixedSize">RefrigeratorSetPointType</span><span class="f_Paragraph"> under </span><span class="f_FixedSize">RefrigeratorAnalogType</span><span class="f_Paragraph"> in </span><span class="f_FixedSize">BaseVariableType - BaseDataVariableType - AnalogItemType.</span><span class="f_Paragraph"> There is also a </span><span class="f_FixedSize">RefrigeratorVariableType</span><span class="f_Paragraph"> in </span><span class="f_FixedSize">BaseVariableType - BaseDataVariableType</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 13px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Courier New';color:#000000;">o</span></td><td style="border:none"><span class="f_Paragraph">Browse the folder </span><span class="f_FixedSize">ObjectTypes</span><span class="f_Paragraph"> which is organized below </span><span class="f_FixedSize">Types</span><span class="f_Paragraph"> folder and observe that there is a </span><span class="f_FixedSize">RefrigeratorType</span><span class="f_Paragraph"> in </span><span class="f_FixedSize">BaseObjectType</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 13px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Courier New';color:#000000;">o</span></td><td style="border:none"><span class="f_Paragraph">Browse the folder </span><span class="f_FixedSize">Devices</span><span class="f_Paragraph"> which is organized below the </span><span class="f_FixedSize">Objects</span><span class="f_Paragraph"> folder and observe that the browse yields references to three nodes representing Refrigerators defined in the xml file.</span></td></tr></table></div><h3 class="p_Heading3"><span class="f_Heading3">Points of Interest</span></h3>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph">The <a href="class_softing_o_p_c_toolbox5_1_1_server_1_1_address_space_root.htm" class="topiclink" title="class_softing_o_p_c_toolbox5_1_1_server_1_1_address_space_root">AddressSpace</a> will be supplemented by importing the xml file by calling </span><span class="f_FixedSize"><a href="class_softing_o_p_c_toolbox5_1_1_server_1_1_address_space_root.htm#class_softing_o_p_c_toolbox5_1_1_server_1_1_address_space_root_1a53e25aa564f979738e65cd241f25da19" class="topiclink">Server::AddressSpaceRoot::instance()-&gt;importNodes()</a></span><span class="f_Paragraph">. </span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph">The NamespaceUris in the XML does not include the NamespaceURI of the OPC Foundation &quot;<a href="http://opcfoundation.org/UA/%22" target="_blank" class="weblink">http://opcfoundation.org/UA/&quot;</a>. Even if this NamespaceURI is not explicitly part of the XML tag &quot;NamespaceUris&quot; it is implicitly treated as available and always has the Namespace ID 0.</span><br />
<span class="f_Paragraph">All other mentioned NamespaceUris in the list are referred in the XML by their 1-based position in the list as Namespace ID.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph">If a Namespace URIs in the xml file does not exists in the AddressSpace it is added at the end of the namespace array. In any case the NamespaceID referring to the URI is adapted to the index in the namespace array. E.g. the xml file contains the namespace &quot;http://Refrigerator_Type/&quot;. The NodeId of the UAObjectType &quot;RefrigeratorObjectType&quot; refers to that namespace with the namespace index 1 in XML. </span><br />
<span class="f_Paragraph">In the AddressSpace after import this NodeId has a different NamespaceId.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none">If there aren't any extensions in the NodeSet.xml file the import method can be called just with the file path. In case of global extensions in the xml file it is possible to receive them by additional parameters on the import method. In the sample code the update rate for the simulation is provided by a global extension. You can find it after the &quot;Aliases&quot; section in the XMLImportSample.xml file around line 30.</td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph">The </span><span class="f_FixedSize">SampleCreator</span><span class="f_Paragraph"> is derived from the </span><span class="f_FixedSize"><a href="class_softing_o_p_c_toolbox5_1_1_creator.htm" class="topiclink">Creator</a></span><span class="f_Paragraph"> and override the </span><span class="f_FixedSize"><a href="class_softing_o_p_c_toolbox5_1_1_creator.htm#class_softing_o_p_c_toolbox5_1_1_creator_1a182244564550c2e3d35bc15a3c053204" class="topiclink">createServerAddressSpaceRoot()</a></span><span class="f_Paragraph"> method to create a </span><span class="f_FixedSize">ServerImportXMLAddressSpaceRoot</span><span class="f_Paragraph"> to get error messages while importing the xml file.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph">The </span><span class="f_FixedSize">SampleCreator</span><span class="f_Paragraph"> also overrides the creation for </span><span class="f_FixedSize"><a href="class_softing_o_p_c_toolbox5_1_1_creator.htm#class_softing_o_p_c_toolbox5_1_1_creator_1a6d3d7891bd49072307f9484abde6255c" class="topiclink">createServerVariableEx2()</a></span><span class="f_Paragraph">, </span><span class="f_FixedSize"><a href="class_softing_o_p_c_toolbox5_1_1_creator.htm#class_softing_o_p_c_toolbox5_1_1_creator_1a8f3fad389d1821a3d97628cb87dd1faa" class="topiclink">createServerObjectEx2()</a></span><span class="f_Paragraph">, </span><span class="f_FixedSize"><a href="class_softing_o_p_c_toolbox5_1_1_creator.htm#class_softing_o_p_c_toolbox5_1_1_creator_1adde4e751e1daf2e800483e7c9d158c78" class="topiclink">createServerMethodEx2()</a></span><span class="f_Paragraph">, </span><span class="f_FixedSize"><a href="class_softing_o_p_c_toolbox5_1_1_creator.htm#class_softing_o_p_c_toolbox5_1_1_creator_1a5212926058f88e480d8c58ae7bd63a03" class="topiclink">createServerObjectTypeEx2()</a></span><span class="f_Paragraph"> and </span><span class="f_FixedSize"><a href="class_softing_o_p_c_toolbox5_1_1_creator.htm#class_softing_o_p_c_toolbox5_1_1_creator_1a598bc0e343a424faa6641e7685676947" class="topiclink">createServerVariableTypeEx2()</a></span><span class="f_Paragraph"> to create the sample objects for the sample classes. With these ...Ex2() methods the last parameter xmlTag the complete Tag of the Node is provided that the user can parse it for additional information. In the sample the refrigerators have their device Ids in the extensions tag. The variables have the corresponding device Id of the refrigerator and an address on the device in the extensions tag. These information are parsed with a tiny libxml2 parser and used for creating the refrigerators.</span><br />
<span class="f_Paragraph">If the XML tag is not necessary within the creator methods (e.g. to decide which calls has to be instantiated) the OPC UA C++ Server &amp; Client SDK V6.00 provides the extensions of a node after it is imported (see </span><a href="class_softing_o_p_c_toolbox5_1_1_server_1_1_base_node.htm#class_softing_o_p_c_toolbox5_1_1_server_1_1_base_node_1aeda4757c19bbb02ed25ef39156a17a45" class="topiclink">Server::BaseNode::getExtensions</a><span class="f_Paragraph">.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph">The </span><span class="f_FixedSize">RefrigeratorSetpoint</span><span class="f_Paragraph"> class is an example how to derive from a <a href="class_softing_o_p_c_toolbox5_1_1_server_1_1_variable.htm" class="topiclink">Server::Variable</a> to create its own implementation. In this example the </span><span class="f_FixedSize"><a href="class_softing_o_p_c_toolbox5_1_1_server_1_1_variable.htm#class_softing_o_p_c_toolbox5_1_1_server_1_1_variable_1a40756a6f376a2389749499cf4a1c1805" class="topiclink">handleWriteRequest()</a></span><span class="f_Paragraph"> is overwritten to check the limits of the provided value.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph">In the OpenCloseMethod class is shown how to handle and derive from the <a href="class_softing_o_p_c_toolbox5_1_1_server_1_1_method.htm" class="topiclink">Server::Method</a>. This class just overwrites the <a href="class_softing_o_p_c_toolbox5_1_1_server_1_1_method.htm#class_softing_o_p_c_toolbox5_1_1_server_1_1_method_1acbb74f4fbca6d6dbad76b53fbfd85cc8" class="topiclink">handleExecuteRequest</a>.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph">After importing the xml file the <a href="class_softing_o_p_c_toolbox5_1_1_server_1_1_address_space_root.htm#class_softing_o_p_c_toolbox5_1_1_server_1_1_address_space_root_1a59ac3fabcb2b3af4ebb660f18287420d" class="topiclink">validate()</a> method is called to validate the extended <a href="class_softing_o_p_c_toolbox5_1_1_server_1_1_address_space_root.htm" class="topiclink" title="class_softing_o_p_c_toolbox5_1_1_server_1_1_address_space_root">Server::AddressSpace</a>. If there are some issues in the address space e.g. a mandatory reference of a variable or object is missing, the <a href="class_softing_o_p_c_toolbox5_1_1_server_1_1_address_space_root.htm#class_softing_o_p_c_toolbox5_1_1_server_1_1_address_space_root_1a8f7a68c7866c4caced3235a5cea83689" class="topiclink">onValidateError()</a> callback is invoked.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph">libxml2 library is provided with the SDK, but it is up to the user which parser should be used for parsing the xml tags provided in the creator.</span></td></tr></table></div><p class="p_Paragraph"><span class="f_Paragraph">&nbsp;</span></p>

      </td>
  </tr>
  <tr>
    <td colspan="2" style="padding-top: 0px;">
         <p>
            <hr />
            <a href="mailto:support.automation@softing.com?subject=OPC UA C++ Server &amp; Client SDK V6.00 Documentation Feedback:Page=html_xmlimport.htm">Send comments on this topic.</a>
         </p>
         <p>
            Copyright © Softing Industrial Automation GmbH&nbsp;2022
         </p>
    </td>
  </tr>
</table>
</body>
</html>
