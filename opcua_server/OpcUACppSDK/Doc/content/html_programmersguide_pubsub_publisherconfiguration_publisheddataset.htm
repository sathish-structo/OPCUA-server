<!DOCTYPE HTML>
<html>
<head>
   <title>Configure PublishedDataSet</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "html_programmersguide_pubsub_publisherconfiguration_publisheddataset.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">

<table width="100%" border="0" cellspacing="0" cellpadding="10">
  <tr valign="middle" bgcolor="#99CCFF">
    <td>
      <p>
        <table width="100%" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td style="vertical-align:middle;">
              <p style="font-family:Verdana; font-size:9pt; font-style:italic;">OPC UA C++ Server &amp; Client SDK V6.00</p>
              <p style="font-family:Verdana; font-size:9pt; font-weight:bold;">Configure PublishedDataSet</p>
            </td>
          </tr>
        </table>
      </p>
    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="html_welcome.htm">Top</a>&nbsp;
     <a href="html_programmersguide_pubsub_publisherconfiguration.htm">Previous</a>&nbsp;
     <a href="html_programmersguide_pubsub_publisherconfiguration_datasetwriter.htm">Next</a>
     </span>
    </td>
  </tr>
  <tr bgcolor="white">
      <td colspan="2">
          <p class="p_Paragraph"><span class="f_Paragraph">The <a href="class_softing_o_p_c_toolbox5_1_1_pub_sub_1_1_published_data_set.htm" class="topiclink">PublishedDataSet</a> describes the data to publish.</span></p>
<p class="p_Paragraph"><span class="f_Paragraph">The OPC UA C++ Server &amp; Client SDK V6.00 currently supports two types of published data sets:</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph"><a href="class_softing_o_p_c_toolbox5_1_1_pub_sub_1_1_published_data_set.htm" class="topiclink">PublishedDataSet</a></span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph"><a href="class_softing_o_p_c_toolbox5_1_1_pub_sub_1_1_published_data_items.htm" class="topiclink">PublishedDataItems</a></span></td></tr></table></div><p class="p_Paragraph"><span class="f_Paragraph">&nbsp;</span></p>
<h2 class="p_Heading2"><span class="f_Heading2">PublishedDataSet</span></h2>
<p class="p_Paragraph"><span class="f_Paragraph">The <a href="class_softing_o_p_c_toolbox5_1_1_pub_sub_1_1_published_data_set.htm" class="topiclink">PublishedDataSet</a> is the concrete base class of the data sets. It can be used to provide any data manually to the data set.</span><br />
<span class="f_Paragraph">It is mandatory to configure the meta data via <a href="class_softing_o_p_c_toolbox5_1_1_pub_sub_1_1_published_data_set.htm#class_softing_o_p_c_toolbox5_1_1_pub_sub_1_1_published_data_set_1abaadf700a2836419aa63385ebfea2f63" class="topiclink">PublishedDataSet::setDataSetMetaData()</a> with a value of the <a href="class_softing_o_p_c_toolbox5_1_1_data_set_meta_data_type.htm" class="topiclink">DataSetMetaDataType</a>.</span><br />
<span class="f_Paragraph">The <a href="class_softing_o_p_c_toolbox5_1_1_data_set_meta_data_type.htm" class="topiclink">DataSetMetaDataType</a> mainly consists of a list of <a href="class_softing_o_p_c_toolbox5_1_1_field_meta_data.htm" class="topiclink">FieldMetaData</a> values</span>, where every <span class="f_Paragraph"><a href="class_softing_o_p_c_toolbox5_1_1_field_meta_data.htm" class="topiclink">FieldMetaData</a> mainly describes the used data type and the order of the list describes the order of the values to provide.</span></p>
<p class="p_Paragraph"><span class="f_Paragraph" style="font-weight: bold;">Note:</span><span class="f_Paragraph"> Every <a href="class_softing_o_p_c_toolbox5_1_1_field_meta_data.htm" class="topiclink">FieldMetaData</a> value needs a unique ID, which shall be unique within one <a href="class_softing_o_p_c_toolbox5_1_1_pub_sub_1_1_published_data_set.htm" class="topiclink">PublishedDataSet</a>, so the same <a href="class_softing_o_p_c_toolbox5_1_1_field_meta_data.htm" class="topiclink">FieldMetaData</a> need not be inserted multiple times for similar fields.</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">Guid&nbsp;dataSetFieldId;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">//&nbsp;FieldMetaData</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">FieldMetaData&nbsp;field0;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">field0.setName(_T(&quot;Field0&quot;));</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">field0.setDescription(LocalizedText(_T(&quot;This&nbsp;is&nbsp;Field&nbsp;0&quot;),&nbsp;_T(&quot;&quot;)));</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">field0.setBuiltInType((OTUInt8)EnumDataTypeId_UInt32);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">field0.setDataType(Statics::DataTypeId_UInt32);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">field0.setValueRank(ValueRank_Scalar);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">dataSetFieldId.parse(_T(&quot;989E96A3-ACC1-4055-A038-DB8B5273BF17&quot;));</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">field0.setDataSetFieldId(dataSetFieldId);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">FieldMetaData&nbsp;field1;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">field1.setName(_T(&quot;Field1&quot;));</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">field1.setDescription(LocalizedText(_T(&quot;This&nbsp;is&nbsp;Field&nbsp;1&quot;),&nbsp;_T(&quot;&quot;)));</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">field1.setBuiltInType((OTUInt8)EnumDataTypeId_Double);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">field1.setDataType(Statics::DataTypeId_Double);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">field1.setValueRank(ValueRank_Scalar);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">dataSetFieldId.parse(_T(&quot;58A2C92F-C9C3-4F1A-A453-E079F8948971&quot;));</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">field1.setDataSetFieldId(dataSetFieldId);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">//&nbsp;MetaData</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">DataSetMetaDataType&nbsp;myMetaData;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">myMetaData.setName(_T(&quot;MyMetaData&quot;));</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">myMetaData.addField(field0);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">myMetaData.addField(field1);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">//&nbsp;DataSet</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">PubSub::PublishedDataSetPtr&nbsp;myDataSet&nbsp;=&nbsp;PubSub::PublishedDataSet::create();</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">myDataSet-&gt;setDataSetMetaData(metaData);</span></p>
<p class="p_Paragraph"><span class="f_Paragraph">&nbsp;</span></p>
<p class="p_Paragraph"><span class="f_Paragraph">During runtime, you can provide the values to publish via <a href="class_softing_o_p_c_toolbox5_1_1_pub_sub_1_1_published_data_set.htm#class_softing_o_p_c_toolbox5_1_1_pub_sub_1_1_published_data_set_1af58f62efb7fd9ff8a57160edabf2521c" class="topiclink">PublishedDataSet::provideCurrentValues()</a>.</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">std::vector&lt;DataValue&gt;&nbsp;currentValues;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">currentValues.push_back(DataValue());</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">currentValues.push_back(DataValue());</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">currentValues[0].getValue()-&gt;setUInt32(15);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">currentValues[1].getValue()-&gt;setDouble(17.0);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">dataSet-&gt;provideCurrentValues(currentValues);</span></p>
<p class="p_Paragraph"><span class="f_Paragraph" style="font-weight: bold;">Note:</span><span class="f_Paragraph"> The provided values must match to the configuration of the configured meta data, otherwise <a href="class_softing_o_p_c_toolbox5_1_1_pub_sub_1_1_published_data_set.htm#class_softing_o_p_c_toolbox5_1_1_pub_sub_1_1_published_data_set_1af58f62efb7fd9ff8a57160edabf2521c" class="topiclink">PublishedDataSet::provideCurrentValues()</a> will reject the provided values.</span></p>
<p class="p_Paragraph"><span class="f_Paragraph" style="font-weight: bold;">Note:</span><span class="f_Paragraph"> Before the <a href="class_softing_o_p_c_toolbox5_1_1_pub_sub_1_1_published_data_set.htm" class="topiclink">PublishedDataSet</a> is used on any operational <a href="class_softing_o_p_c_toolbox5_1_1_pub_sub_1_1_data_set_writer.htm" class="topiclink">DataSetWriter</a>, you should also call <a href="class_softing_o_p_c_toolbox5_1_1_pub_sub_1_1_published_data_set.htm#class_softing_o_p_c_toolbox5_1_1_pub_sub_1_1_published_data_set_1af58f62efb7fd9ff8a57160edabf2521c" class="topiclink">PublishedDataSet::provideCurrentValues()</a> to provide an initial value to the published fields, otherwise the <a href="class_softing_o_p_c_toolbox5_1_1_pub_sub_1_1_published_data_set.htm" class="topiclink">PublishedDataSet</a> will publish NULL-values before the first value is provided.</span></p>
<p class="p_Paragraph"><span class="f_Paragraph" style="font-weight: bold;">Note:</span><span class="f_Paragraph"> The OPC UA C++ Server &amp; Client SDK V6.00 will publish the latest provided values whenever the internal publishing timer expires, so there is no need to provide the current values in the matching publishing interval.</span></p>
<p class="p_Paragraph"><span class="f_Paragraph">&nbsp;</span></p>
<h2 class="p_Heading2"><span class="f_Heading2">PublishedDataItems</span></h2>
<p class="p_Paragraph"><span class="f_Paragraph">The <a href="class_softing_o_p_c_toolbox5_1_1_pub_sub_1_1_published_data_items.htm" class="topiclink">PublishedDataItems</a> is a specialized subtype of the <a href="class_softing_o_p_c_toolbox5_1_1_pub_sub_1_1_published_data_set.htm" class="topiclink">PublishedDataSet</a> and can extract the data to publish automatically from address space nodes.</span></p>
<p class="p_Paragraph"><span class="f_Paragraph" style="font-weight: bold;">Note:</span><span class="f_Paragraph"> The <a href="class_softing_o_p_c_toolbox5_1_1_pub_sub_1_1_published_data_items.htm" class="topiclink">PublishedDataItems</a> can only be used on a server application.</span></p>
<p class="p_Paragraph"><span class="f_Paragraph">The <a href="class_softing_o_p_c_toolbox5_1_1_pub_sub_1_1_published_data_items.htm" class="topiclink">PublishedDataItems</a> also requires to configure the meta data, like for the <a href="class_softing_o_p_c_toolbox5_1_1_pub_sub_1_1_published_data_set.htm" class="topiclink">PublishedDataSet</a>.</span><br />
<span class="f_Paragraph">Besides the meta data, the <a href="class_softing_o_p_c_toolbox5_1_1_pub_sub_1_1_published_data_items.htm" class="topiclink">PublishedDataItems</a> additionally needs to configure a <a href="class_softing_o_p_c_toolbox5_1_1_published_data_items_data_type.htm" class="topiclink">PublishedDataItemsDataType</a>, which is a list of <a href="class_softing_o_p_c_toolbox5_1_1_published_variable_data_type.htm" class="topiclink">PublishedVariableDataType</a>.</span><br />
<span class="f_Paragraph">The <a href="class_softing_o_p_c_toolbox5_1_1_published_variable_data_type.htm" class="topiclink">PublishedVariableDataType</a> mainly describes the desired node and attribute.</span><br />
<span class="f_Paragraph">Finally assign the <a href="class_softing_o_p_c_toolbox5_1_1_pub_sub_1_1_published_data_items.htm" class="topiclink">PublishedDataItems</a> as the source of the data via <a href="class_softing_o_p_c_toolbox5_1_1_pub_sub_1_1_published_data_set.htm#class_softing_o_p_c_toolbox5_1_1_pub_sub_1_1_published_data_set_1a6e7d0fd60f304eef75a1fa2fd63d2c60" class="topiclink">PublishedDataSet::setDataSetSource()</a></span></p>
<p class="p_CodeExample"><span class="f_CodeExample">PubSub::PublishedDataItemsPtr&nbsp;myDataItems&nbsp;=&nbsp;PubSub::PublishedDataItems::create();</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">PublishedDataItemsDataType&nbsp;myDataItemsData;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">//&nbsp;assign&nbsp;the&nbsp;meta&nbsp;data&nbsp;to&nbsp;myDataItems</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">...</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">PublishedVariableDataType&nbsp;uint32PublishedVariable;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">uint32PublishedVariable.setPublishedVariable(NodeId(1,&nbsp;_T(&quot;MyUInt32Variable&quot;));</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">uint32PublishedVariable.setAttributeId(EnumAttributeId_Value);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">myDataItemsData.addPublishedData(uint32PublishedVariable);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">PublishedVariableDataType&nbsp;doublePublishedVariable;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">doublePublishedVariable.setPublishedVariable(NodeId(1,&nbsp;_T(&quot;MyDoubleVariable&quot;));</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">doublePublishedVariable.setAttributeId(EnumAttributeId_Value);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">myDataItemsData.addPublishedData(doublePublishedVariable);</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">myDataItems-&gt;setDataSetSource(myDataItemsData);</span></p>
<p class="p_Paragraph"><span class="f_Paragraph" style="font-weight: bold;">Note:</span><span class="f_Paragraph"> The amount, order and types of the <a href="class_softing_o_p_c_toolbox5_1_1_published_variable_data_type.htm" class="topiclink">PublishedVariableDataType</a> values in the configured <a href="class_softing_o_p_c_toolbox5_1_1_published_data_items_data_type.htm" class="topiclink">PublishedDataItemsDataType</a> must match to the meta data.</span></p>

      </td>
  </tr>
  <tr>
    <td colspan="2" style="padding-top: 0px;">
         <p>
            <hr />
            <a href="mailto:support.automation@softing.com?subject=OPC UA C++ Server &amp; Client SDK V6.00 Documentation Feedback:Page=html_programmersguide_pubsub_publisherconfiguration_publisheddataset.htm">Send comments on this topic.</a>
         </p>
         <p>
            Copyright © Softing Industrial Automation GmbH&nbsp;2022
         </p>
    </td>
  </tr>
</table>
</body>
</html>
