<!DOCTYPE HTML>
<html>
<head>
   <title>Limited Resources</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "html_samplelimitedresources.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">

<table width="100%" border="0" cellspacing="0" cellpadding="10">
  <tr valign="middle" bgcolor="#99CCFF">
    <td>
      <p>
        <table width="100%" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td style="vertical-align:middle;">
              <p style="font-family:Verdana; font-size:9pt; font-style:italic;">OPC UA C++ Server &amp; Client SDK V6.00</p>
              <p style="font-family:Verdana; font-size:9pt; font-weight:bold;">Limited Resources</p>
            </td>
          </tr>
        </table>
      </p>
    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="html_welcome.htm">Top</a>&nbsp;
     <a href="html_samplediscoveryservice.htm">Previous</a>&nbsp;
     <a href="html_sampleuseraccesscontrol.htm">Next</a>
     </span>
    </td>
  </tr>
  <tr bgcolor="white">
      <td colspan="2">
          <p class="p_Paragraph"><a id="hdr"></a><span class="f_Paragraph">For machines with limited resources it is possible to restrict the resource usage in the server.</span></p>
<p class="p_Paragraph"><span class="f_Paragraph">Possible restrictions are</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph">allowed numbers of sessions</span><br />
<span class="f_Paragraph">Each session requires both memory and other system resources (e.g. file handles, ...)</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph">allowed numbers of subscriptions</span><br />
<span class="f_Paragraph">Each subscription requires both memory and CPU time for data notifications</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph">allowed numbers of monitored items</span><br />
<span class="f_Paragraph">Each monitored item requires both memory and CPU time for data notifications</span></td></tr></table></div><p class="p_Paragraph"><span class="f_Paragraph">The C++ sample project </span><span class="f_Reference">ServerWithLimitedResource</span><span class="f_Paragraph"> demonstrates how to custom an OPC server for this purpose.</span></p>
<p class="p_Paragraph"><span class="f_Paragraph">&nbsp;</span></p>
<p class="p_Paragraph"><span class="f_Paragraph">The consumption of the system resources could be affected also by following attributes: </span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph">Timeout for sessions.</span><br />
<span class="f_Paragraph">In case of limited sessions it is advisable that broken sessions are detected faster than usual.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph">Llifetime interval, max keep alive count and publishing interval for subscriptions.</span><br />
<span class="f_Paragraph">In case of limited subscriptions it is advisable that dead subscriptions are detected faster than usual.</span><br />
<span class="f_Paragraph">Small publish intervals increase CPU load.</span><br />
<span class="f_Paragraph">With revising the keep alive count only minimal resource improvement is possible.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph">Sampling interval and queue size for monitored items.</span><br />
<span class="f_Paragraph">Big queue sizes will increase memory consumption.</span><br />
<span class="f_Paragraph">Small sampling intervals will cause fast filling of the monitored item queue.</span><br />
<span class="f_Paragraph">Queue size, sampling interval and publishing interval are related!</span><br />
<span class="f_Paragraph">E.g. just reducing the queue size may lead to a queue overflow.</span></td></tr></table></div><p class="p_Paragraph"><span class="f_Paragraph">These attributes can be assigned with min/max limits globally in the application instance or set individually in the callback functions, when the objects are created or modified.</span><br />
<span class="f_Paragraph">In our sample some of them (time out for sessions, lifetime interval and max keep alive count for subscriptions) are set in the callbacks on creations by the functions <a href="class_softing_o_p_c_toolbox5_1_1_server_1_1_session.htm#class_softing_o_p_c_toolbox5_1_1_server_1_1_session_1a2bfa7f5e0754d847e91c5ff56b96fec1" class="topiclink">setTimeout()</a>, <a href="class_softing_o_p_c_toolbox5_1_1_server_1_1_subscription.htm#class_softing_o_p_c_toolbox5_1_1_server_1_1_subscription_1a8a265e03041b0a3945cafde840e467e2" class="topiclink">setLifetimeCount()</a> and <a href="class_softing_o_p_c_toolbox5_1_1_server_1_1_subscription.htm#class_softing_o_p_c_toolbox5_1_1_server_1_1_subscription_1a69d1b3ec13c45f5f8efb0eaaff54f64f" class="topiclink">setMaxKeepAliveCount()</a> of corresponding classes.</span></p>
<p class="p_Paragraph"><span class="f_Paragraph">The other limits (publishing interval for subscriptions, sampling interval and queue sizes for monitored items) are configured globally for the application by calling functions of the <a href="class_softing_o_p_c_toolbox5_1_1_application.htm" class="topiclink">Application</a> instance: <a href="class_softing_o_p_c_toolbox5_1_1_application.htm#class_softing_o_p_c_toolbox5_1_1_application_1a994aff3f90606256eb81041c1d41df59" class="topiclink">setMinPublishingInterval</a>, <a href="class_softing_o_p_c_toolbox5_1_1_application.htm#class_softing_o_p_c_toolbox5_1_1_application_1a0f64303a399cdb235c80c8f328da7653" class="topiclink">setMaxPublishingInterval</a>, <a href="class_softing_o_p_c_toolbox5_1_1_application.htm#class_softing_o_p_c_toolbox5_1_1_application_1a3aeb3fed5139b1b74cd257ddcc9ce587" class="topiclink">setMinSamplingInterval</a>, <a href="class_softing_o_p_c_toolbox5_1_1_application.htm#class_softing_o_p_c_toolbox5_1_1_application_1ac7fd511b9a6815d73077efd8e56bd973" class="topiclink">setMaxSamplingInterval</a>, <a href="class_softing_o_p_c_toolbox5_1_1_application.htm#class_softing_o_p_c_toolbox5_1_1_application_1a8298e48b9fa358568e8af50cb343d2e9" class="topiclink">setMaxDataChangeMonitoringQueueSize()</a>, <a href="class_softing_o_p_c_toolbox5_1_1_application.htm#class_softing_o_p_c_toolbox5_1_1_application_1a86f827f8937fe4a740eebbf508c53656" class="topiclink">setMaxEventMonitoringQueueSize()</a> .</span></p>
<p class="p_Paragraph"><span class="f_Paragraph">For test of the sample you can use the client project </span><span class="f_Reference">TestLimitedResources</span><span class="f_Paragraph">.</span></p>
<h3 class="p_Heading3"><span class="f_Heading3">Where to Find</span></h3>
<p class="p_Paragraph"><span class="f_Paragraph">The projects for this sample are located in the directory: &quot;</span><span class="f_FixedSize">&lt;InstallDir&gt;/Apps/Samples/Cpp/LimitedResources</span><span class="f_Paragraph">&quot;. While the subdirectory &quot;</span><span class="f_FixedSize">ServerWithLimitedResources</span><span class="f_Paragraph">&quot; contains source for the server, the client project for test can be found in &quot;</span><span class="f_FixedSize">TestLimitedResource</span><span class="f_Paragraph">&quot; subdirectory.</span></p>
<h3 class="p_Heading3"><span class="f_Heading3">Running the Sample</span></h3>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph">The client and server need an existing application instance certificate and it must be in the correct directory. See <a href="html_setupcertificates.htm" class="topiclink">Setting up a Certificate Store</a> for how to create the demo certificate store. The path to the certificate is specified at the top of </span><span class="f_FixedSize">ServerWithLimitedRes.cpp </span><span class="f_Paragraph">and</span><span class="f_FixedSize"> TestLimitedResource.cpp</span><span class="f_Paragraph">, adapt it if it doesn't fit.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph">This server uses a project with a platform independent semaphore support which must be located relatively on &quot;</span><span class="f_FixedSize">../../Utilities</span><span class="f_Paragraph">&quot;.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 13px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Courier New';color:#000000;">o</span></td><td style="border:none"><span class="f_Paragraph">Windows: The installed folder structure ensures that the </span><span class="f_Reference">Utilities</span><span class="f_Paragraph"> projects is on the desired location, the library &quot;</span><span class="f_FixedSize">Utilities.lib</span><span class="f_Paragraph">&quot; will be generated in the same path as the already set SDK libraries. (See <a href="html_windows.htm#toolkit_components_binary" class="topiclink">Windows Installation Directory Structure</a>).</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 13px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Courier New';color:#000000;">o</span></td><td style="border:none"><span class="f_Paragraph">Linux: The installed folder structure ensures that the </span><span class="f_Reference">Utilities</span><span class="f_Paragraph"> project is on the desired location, the library &quot;</span><span class="f_FixedSize">libutilities.lib</span><span class="f_Paragraph">&quot; will be generated in the same path as the already set SDK libraries. (See <a href="html_linux.htm#toolkit_components_binary" class="topiclink">Linux Installation Directory Structure</a>).</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 13px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Courier New';color:#000000;">o</span></td><td style="border:none"><span class="f_Paragraph">VxWorks: The </span><span class="f_Reference">Utilities</span><span class="f_Paragraph"> example project must be created to the Workspace to be able to run the sample. This is done the same way as creating the sample projects (see <a href="html_gettingstarted.htm" class="topiclink">Programming Tutorial</a>).</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph">Compile the </span><span class="f_Reference">Utilities</span><span class="f_Paragraph"> project to create the library.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph">Compile and start the sample applications </span><span class="f_Reference">ServerWithLimitedResource</span><span class="f_Paragraph"> and </span><span class="f_Reference">TestLimitedResources</span><span class="f_Paragraph">. Run the server application in the debugger and step through the code.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph">On the client use the commands &quot;</span><span class="f_Reference">co</span><span class="f_Paragraph">&quot; (connect), &quot;</span><span class="f_FixedSize">as [n]</span><span class="f_Paragraph">&quot; (add subscription), &quot;</span><span class="f_FixedSize">rs</span><span class="f_Paragraph">&quot; (remove subscription) and &quot;</span><span class="f_FixedSize">di</span><span class="f_Paragraph">&quot; (disconnect) to test the server application.</span><br />
<span class="f_Paragraph">The client can create multiple sessions, the subscription commands and the disconnect command are executed on the selected subscription (&quot;se&quot; command).</span></td></tr></table></div><p><span class="f_Heading3">Points of Interest</span></p>
<p class="p_Paragraph"><span class="f_Paragraph">Server:</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph">Count the active sessions in the overridden methods <a href="class_softing_o_p_c_toolbox5_1_1_server_1_1_endpoint.htm#class_softing_o_p_c_toolbox5_1_1_server_1_1_endpoint_1a278e45207dd9a7cec0fea26c630ebef3" class="topiclink">onCreateSession()</a> and <a href="class_softing_o_p_c_toolbox5_1_1_server_1_1_endpoint.htm#class_softing_o_p_c_toolbox5_1_1_server_1_1_endpoint_1a74756e4fa7405d7dab98baad82bbcb2d" class="topiclink">handleDeleteSession()</a> in the derived endpoint class.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph">Count the active subscriptions in the overridden methods <a href="class_softing_o_p_c_toolbox5_1_1_server_1_1_subscription.htm#class_softing_o_p_c_toolbox5_1_1_server_1_1_subscription_1ad0a86f8e732976e52633d025475b8af8" class="topiclink">onCreate()</a> and <a href="class_softing_o_p_c_toolbox5_1_1_server_1_1_subscription.htm#class_softing_o_p_c_toolbox5_1_1_server_1_1_subscription_1a494a40ca9e8bc31ba494de09febc0422" class="topiclink">handleDelete()</a> in the derived subscription class.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 5px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:9pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Paragraph">Count the active monitored items the overridden methods <a href="class_softing_o_p_c_toolbox5_1_1_server_1_1_subscription.htm#class_softing_o_p_c_toolbox5_1_1_server_1_1_subscription_1adb03a5fe96e251f989d03a5c641b5f0b" class="topiclink">handleCreateMonitoredItems()</a> and <a href="class_softing_o_p_c_toolbox5_1_1_server_1_1_subscription.htm#class_softing_o_p_c_toolbox5_1_1_server_1_1_subscription_1a75b4931dcf2609afed7fe626d4044b0e" class="topiclink">handleDeleteMonitoredItems()</a> in the derived subscription class.</span></td></tr></table></div><h3 class="p_Heading3"><span class="f_Heading3">Note:</span></h3>
<p class="p_Paragraph"><span class="f_Paragraph">The limits and settings in this project are for demonstration purposes only.</span></p>
<p class="p_Paragraph"><span class="f_Paragraph">Any implementation on customer servers - especially protection of counters - should be adapted.</span></p>

      </td>
  </tr>
  <tr>
    <td colspan="2" style="padding-top: 0px;">
         <p>
            <hr />
            <a href="mailto:support.automation@softing.com?subject=OPC UA C++ Server &amp; Client SDK V6.00 Documentation Feedback:Page=html_samplelimitedresources.htm">Send comments on this topic.</a>
         </p>
         <p>
            Copyright © Softing Industrial Automation GmbH&nbsp;2022
         </p>
    </td>
  </tr>
</table>
</body>
</html>
